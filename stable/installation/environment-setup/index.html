<!DOCTYPE html>
<html>
  <head>
    <title>Crunchy Data Container Suite Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.48" />

<title>Environment Setup :: Crunchy Data Container Suite Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/crunchy-containers/stable/favicon.ico" type="image/x-icon" />
<link href="https://crunchydata.github.io/crunchy-containers/stable/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/stable/css/font-awesome.min.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/stable/css/hybrid.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/stable/css/featherlight.min.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/stable/css/auto-complete.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/stable/theme-original/style.css" rel="stylesheet">

<link rel="stylesheet" href="https://crunchydata.github.io/crunchy-containers/stable/css/bootstrap.min.css">
<script src="https://crunchydata.github.io/crunchy-containers/stable/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<meta name="description" content="">


    
  </head>
  <body data-url="/installation/environment-setup/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a class="baselink" href="https://crunchydata.github.io/crunchy-containers/stable/">Crunchy Data Container Suite Documentation</a>
  

    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/stable/js/lunr.min.js"></script>
		<script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/stable/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "https:\/\/crunchydata.github.io\/crunchy-containers\/stable\/";
        
		</script>
		<script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/stable/js/search.js"></script>
  </div>

      <ul class="topics">
            <li data-nav-id="/" class="dd-item">
            <a href="https://crunchydata.github.io/crunchy-containers/stable/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/installation/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/stable/installation/">Installation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="/installation/environment-setup/" class="dd-item active">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/installation/environment-setup/">
            Environment Setup
          </a>
        </div>
    </li>
      <li data-nav-id="/installation/build-the-containers/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/installation/build-the-containers/">
            Build the Containers
          </a>
        </div>
    </li>
      <li data-nav-id="/installation/storage-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/installation/storage-configuration/">
            Storage Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/stable/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="/getting-started/kubernetes-and-openshift/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/stable/getting-started/kubernetes-and-openshift/">Kubernetes and Openshift</a>

      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/container-specifications/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/">Container Specifications</a><i class="fa fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="/container-specifications/crunchy-postgres/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-postgres/">
            crunchy-postgres
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-postgres-gis/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-postgres-gis/">
            crunchy-postgres-gis
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-backup/">
            crunchy-backup
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-backrest-restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-backrest-restore/">
            crunchy-backrest-restore
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgdump/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-pgdump/">
            crunchy-pgdump
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgrestore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-pgrestore/">
            crunchy-pgrestore
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-collect/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-collect/">
            crunchy-collect
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-scheduler/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-scheduler/">
            crunchy-scheduler
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-prometheus/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-prometheus/">
            crunchy-prometheus
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-grafana/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-grafana/">
            crunchy-grafana
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgadmin4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-pgadmin4/">
            crunchy-pgadmin4
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-watch/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-watch/">
            crunchy-watch
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-vacuum/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-vacuum/">
            crunchy-vacuum
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-upgrade/">
            crunchy-upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-sim/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-sim/">
            crunchy-sim
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-pgbouncer/">
            crunchy-pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgpool/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-pgpool/">
            crunchy-pgpool
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgbadger/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/stable/container-specifications/crunchy-pgbadger/">
            crunchy-pgbadger
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/contributing/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/stable/contributing/">Contributing</a>

      </div>
    </li>



        <section id="shortcuts">
                <li class="" role=""><h3>More</h3><a href="https://github.com/CrunchyData/crunchy-containers" target="_blank" rel="noopener"><i class='fa fa-github'></i> <label>Github repo</label></a></li>
                <li class="" role=""><a href="https://kubernetes.io/docs/" target="_blank" rel="noopener"><i class='fa fa-bookmark'></i> <label>Kubernetes Documentation</label></a></li>
                <li class="" role=""><a href="https://github.com/CrunchyData/crunchy-containers/blob/master/LICENSE.md" target="_blank" rel="noopener"><i class='fa fa-file'></i> <label>License</label></a></li>
        </section>

    <hr />
    <li></li>

    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    
      
      
      
    <div id="top-github-link">
      <a class="github-link" href="https://crunchydata.github.io/crunchy-containers/stable/contributing/" target="blank">
        <i class="fa fa-info-circle"></i>
        How to contribute
      </a>
      <a class="github-link" href="https://github.com/CrunchyData/crunchy-containers/edit/master/hugo/content/installation/environment-setup.adoc" target="blank">
        <i class="fa fa-code-fork"></i>
        Improve this page
      </a>
    </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        







 <a href='https://crunchydata.github.io/crunchy-containers/stable/'>Crunchy Data Container Suite</a> > <a href='https://crunchydata.github.io/crunchy-containers/stable/installation/'>Installation</a> > Environment Setup






        </span>
    </div>

    
    <div class="progress">
        <div class="wrapper">
    
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Environment Setup</h1>
  



    
    
    
    <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_project_environment">Project Environment</a></li>
<li><a href="#_installing_requirements">Installing Requirements</a>
<ul class="sectlevel2">
<li><a href="#_centos_7">CentOS 7</a></li>
<li><a href="#_rhel_7">RHEL 7</a></li>
<li><a href="#_postgresql">PostgreSQL</a></li>
<li><a href="#_docker">Docker</a></li>
<li><a href="#_openshift">OpenShift</a></li>
<li><a href="#_kubernetes">Kubernetes</a></li>
<li><a href="#_helm">Helm</a></li>
</ul>
</li>
<li><a href="#_creating_a_demo_namespace">Creating a Demo Namespace</a>
<ul class="sectlevel2">
<li><a href="#_kubernetes_2">Kubernetes</a></li>
<li><a href="#_openshift_2">OpenShift</a></li>
</ul>
</li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div class="paragraph">
<p>Latest Release: 2.2.0 2018-11-27</p>
</div>
<div class="sect1">
<h2 id="_requirements">Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Crunchy Container Suite can run on different environments including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Docker 1.13+</strong></p>
</li>
<li>
<p><strong>OpenShift Container Platform 3.11</strong></p>
</li>
<li>
<p><strong>Kubernetes 1.8+</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this document we list the basic installation steps required for these
environments.</p>
</div>
<div class="paragraph">
<p>These installation instructions are developed and tested for the following operating systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CentOS 7</strong></p>
</li>
<li>
<p><strong>RHEL 7</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_environment">Project Environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First add the following lines to your .bashrc file to set
the project paths:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>export GOPATH=$HOME/cdev
export GOBIN=$GOPATH/bin
export PATH=$PATH:$GOBIN
export CCP_BASEOS=centos7
export CCP_PGVERSION=10
export CCP_PG_FULLVERSION=10.6
export CCP_VERSION=2.2.0
export CCP_IMAGE_PREFIX=crunchydata
export CCP_IMAGE_TAG=$CCP_BASEOS-$CCP_PG_FULLVERSION-$CCP_VERSION
export CCPROOT=$GOPATH/src/github.com/crunchydata/crunchy-containers
export CCP_SECURITY_CONTEXT=""
export CCP_CLI=kubectl
export CCP_NAMESPACE=demo</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>Please see the <a href="https://crunchydata.github.io/crunchy-containers/stable/installation/storage-configuration/">Storage Configuration</a> document
for configuring storage using environment variables set in .bashrc.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>CCP_CLI</code> setting above indicates you are running the
examples on a Kubernetes platform and not an OpenShift platform.  For
OpenShift, use the value of <strong>oc</strong> as the <code>CCP_CLI</code> variable instead.</p>
</div>
</div>

</div>
<div class="paragraph">
<p>It will be necessary to refresh your <code>.bashrc</code> file in order for the changes to take
effect.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>. ~/.bashrc</pre>
</div>
</div>
<div class="paragraph">
<p>Next, set up a project directory structure and pull down the project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mkdir -p $HOME/cdev/src/github.com/crunchydata $HOME/cdev/pkg $HOME/cdev/bin</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_requirements">Installing Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_centos_7">CentOS 7</h3>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install golang git docker
cd $GOPATH/src/github.com/crunchydata
git clone https://github.com/crunchydata/crunchy-containers
cd crunchy-containers
git checkout 2.2.0
go get github.com/blang/expenv</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>If you are a Crunchy enterprise customer, you will place the Crunchy repository
key and yum repository file into the <code>$CCPROOT/conf</code> directory at this point. These
files can be obtained through <a href="https://access.crunchydata.com/" class="bare">https://access.crunchydata.com/</a> on the downloads
page.</p>
</div>
</div>

</div>
</div>
<div class="sect2">
<h3 id="_rhel_7">RHEL 7</h3>
<div class="paragraph">
<p>When setting up the environment on RHEL 7, there are slightly different steps that
need to be taken.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo subscription-manager repos --enable=rhel-7-server-optional-rpms
sudo yum-config-manager --enable rhel-7-server-extras-rpms
sudo yum -y install git golang
cd $GOPATH/src/github.com/crunchydata
git clone https://github.com/crunchydata/crunchy-containers
cd crunchy-containers
git checkout 2.2.0
go get github.com/blang/expenv</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>If you are a Crunchy enterprise customer, you will place the Crunchy repository
key and yum repository file into the <code>$CCPROOT/conf</code> directory at this point. These
files can be obtained through <a href="https://access.crunchydata.com/" class="bare">https://access.crunchydata.com/</a> on the downloads
page.</p>
</div>
</div>

</div>
</div>
<div class="sect2">
<h3 id="_postgresql">PostgreSQL</h3>
<div class="paragraph">
<p>These installation instructions assume the installation of PostgreSQL 10
through the official PGDG repository. View the documentation located
<a href="https://wiki.postgresql.org/wiki/YUM_Installation">here</a> in
order to view more detailed notes or install a different version of PostgreSQL.</p>
</div>
<div class="paragraph">
<p>Locate and edit your distribution&#8217;s <code>.repo</code> file, located:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On CentOS: /etc/yum.repos.d/CentOS-Base.repo, [base] and [updates] sections</p>
</li>
<li>
<p>On Red Hat: /etc/yum/pluginconf.d/rhnplugin.conf [main] section</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To the section(s) identified above, you need to append a line (otherwise
dependencies might resolve to the PostgreSQL supplied by the base repository):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>exclude=postgresql*</pre>
</div>
</div>
<div class="paragraph">
<p>Next, install the RPM relating to the base operating system and PostgreSQL version
you wish to install. The RPMs can be found <a href="https://yum.postgresql.org/repopackages.php">here</a>.</p>
</div>
<div class="paragraph">
<p>For example, to install PostgreSQL 10 on a CentOS 7 system:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install https://download.postgresql.org/pub/repos/yum/10/redhat/rhel-7-x86_64/pgdg-centos10-10-2.noarch.rpm</pre>
</div>
</div>
<div class="paragraph">
<p>Or to install PostgreSQL 10 on a RHEL 7 system:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install https://download.postgresql.org/pub/repos/yum/testing/10/redhat/rhel-7-x86_64/pgdg-redhat10-10-2.noarch.rpm</pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll need to update your system:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y update</pre>
</div>
</div>
<div class="paragraph">
<p>Then, go ahead and install the PostgreSQL server package.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install postgresql10-server.x86_64</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_docker">Docker</h3>
<div class="paragraph">
<p>As good practice, at this point you&#8217;ll update your system.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y update</pre>
</div>
</div>
<div class="paragraph">
<p>Now we&#8217;ll install Docker.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install docker</pre>
</div>
</div>
<div class="paragraph">
<p>After that, it&#8217;s necessary to add the <code>docker</code> group and give your user access
to that group (here referenced as <strong>someuser</strong>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo groupadd docker
sudo usermod -a -G docker someuser</pre>
</div>
</div>
<div class="paragraph">
<p>Remember to log out of the <strong>someuser</strong> account for the Docker group
to be added to your current session.  Once it&#8217;s added, you&#8217;ll be able
to run Docker commands from your user account.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>su - someuser</pre>
</div>
</div>
<div class="paragraph">
<p>Next, we enable and start up Docker:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl enable docker.service
sudo systemctl start docker.service</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift">OpenShift</h3>
<div class="paragraph">
<p>See the OpenShift installation guide for details on how to install
OpenShift Enterprise on your host. The main instructions are here:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.openshift.com/container-platform/3.11/install/index.html" class="bare">https://docs.openshift.com/container-platform/3.11/install/index.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes">Kubernetes</h3>
<div class="paragraph">
<p>See <a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/">kubeadm</a>
for installing the latest version of Kubernetes.</p>
</div>
<div class="paragraph">
<p>Please see <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/">here</a>
to view the official documentation regarding configuring DNS for your Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>Make sure your hostname resolves to a single IP address in your
/etc/hosts file. The NFS examples will not work otherwise and other problems
with installation can occur unless you have a resolving hostname.</p>
</div>
<div class="paragraph">
<p>You should see a single IP address returned from this command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ hostname --ip-address</pre>
</div>
</div>
<div class="paragraph">
<p>In order to run the various examples, Role Based Account Control will need to be set up.
Specifically, the <strong>cluster-admin</strong> role will need to be assigned to the Kubernetes user
that will be utilized to run the examples.  This is done by creating the proper
<strong>ClusterRoleBinding</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create clusterrolebinding cluster-admin-binding \
--clusterrole cluster-admin --user someuser</pre>
</div>
</div>
<div class="paragraph">
<p>If you are running on GKE, the following command can be utilized to auto-populate the <strong>user</strong>
option with the account that is currently logged into Google Cloud:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create clusterrolebinding cluster-admin-binding \
--clusterrole cluster-admin --user $(gcloud config get-value account)</pre>
</div>
</div>
<div class="paragraph">
<p>If more than one user will be running the examples on the same Kubernetes cluster, a unique name
will need to be provided for each new <strong>ClusterRoleBinding</strong> created in order to assign the
<strong>cluster-admin</strong> role to every user.  The example below will create a <strong>ClusterRoleBinding</strong> with a
unique value:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create clusterrolebinding &lt;unique&gt;-cluster-admin-binding \
    --clusterrole cluster-admin \
    --user someuser</pre>
</div>
</div>
<div class="paragraph">
<p>If you are running on GKE, the following can be utilized to create a unique <strong>ClusterRoleBinding</strong>
for each user, with the user&#8217;s Google Cloud account prepended to the name of each new
<strong>ClusterRoleBinding</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create clusterrolebinding "$(gcloud config get-value account)-cluster-admin-binding" \
    --clusterrole cluster-admin \
    --user $(gcloud config get-value account)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_helm">Helm</h3>
<div class="paragraph">
<p>Some Kubernetes Helm examples are provided in the following directory as one
option for deploying the Container Suite.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$CCPROOT/examples/helm/</pre>
</div>
</div>
<div class="paragraph">
<p>Once you have your Kubernetes environment configured, it is simple to get
Helm up and running. Please refer to <a href="https://github.com/kubernetes/helm/blob/master/docs/install.md">this document</a>
to get Helm installed and configured properly.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_demo_namespace">Creating a Demo Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Kubernetes, a concept called a <strong>namespace</strong> provides the means to separate
created resources or components into individual logically grouped partitions.</p>
</div>
<div class="paragraph">
<p>It is considered a best practice to have dedicated namespaces for projects in
both testing and production environments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All examples in the Crunchy Container Suite operate within the namespace
defined by the environment variable <code>$CCP_NAMESPACE</code>. The instructions below
illustrate how to set up and work within new namespaces or projects in both
Kubernetes and OpenShift.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_kubernetes_2">Kubernetes</h3>
<div class="paragraph">
<p>This section will illustrate how to set up a new Kubernetes namespace called <strong>demo</strong>, and will
then show how to provide permissions to that namespace to allow the Kubernetes examples to run
within that namespace.</p>
</div>
<div class="paragraph">
<p>First, view currently existing namespaces:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get namespace
NAME          STATUS    AGE
default       Active    21d
kube-public   Active    21d
kube-system   Active    21d</pre>
</div>
</div>
<div class="paragraph">
<p>Then, create a new namespace called <strong>demo</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create -f $CCPROOT/conf/demo-namespace.json
namespace "demo" created
$ kubectl get namespace demo
NAME      STATUS    AGE
demo      Active    7s</pre>
</div>
</div>
<div class="paragraph">
<p>Then set the namespace as the current location to avoid using the wrong namespace:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl config set-context $(kubectl config current-context) --namespace=demo</pre>
</div>
</div>
<div class="paragraph">
<p>We can verify that the namespace was set correctly through the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl config view | grep namespace:
    namespace: demo</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift_2">OpenShift</h3>
<div class="paragraph">
<p>This section assumes you are first logging into OpenShift as a normal
user such as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc login -u someuser</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>For the best results, it is recommended that you run the examples with a user that has <strong>NOT</strong> been
assigned the <strong>cluster-admin</strong> cluster role.</p>
</div>
</div>

</div>
<div class="paragraph">
<p>For our development purposes only, we typically specify the OCP
Authorization policy of <code>AllowAll</code> as documented here:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.openshift.com/container-platform/3.11/install_config/configuring_authentication.html#AllowAllPasswordIdentityProvider" class="bare">https://docs.openshift.com/container-platform/3.11/install_config/configuring_authentication.html#AllowAllPasswordIdentityProvider</a></p>
</div>
<div class="paragraph">
<p>We do not recommend this authentication policy for a production
deployment of OCP.</p>
</div>
<div class="paragraph">
<p>The next step is to create a <strong>demo</strong> namespace to run the examples within. The
name of this OCP project will be what you supply in the CCP_NAMESPACE
environment variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc new-project demo --description="Crunchy Containers project" --display-name="Crunchy-Containers"
Now using project "demo" on server "https://127.0.0.1:8443".

$ export CCP_NAMESPACE=demo</pre>
</div>
</div>
<div class="paragraph">
<p>If we view the list of projects, we can see the new project has been added and is "active".</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc get projects
NAME        DISPLAY NAME         STATUS
demo        Crunchy-Containers   Active
myproject   My Project           Active</pre>
</div>
</div>
<div class="paragraph">
<p>If you were on a different project and wanted to switch to the demo project, you would do
so by running the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc project demo
Now using project "demo" on server "https://127.0.0.1:8443".</pre>
</div>
</div>
<div class="paragraph">
<p>When self-provisioning a new project using the <code>oc new-project</code> command, the current user (i.e.,
the user you used when logging into OCP with the <code>oc login</code> command) will automatically be assigned
to the <strong>admin</strong> role for that project.  This will allow the user to create the majority of the
objects needed to successfully run the examples.  However, in order to create the <strong>Persistent
Volume</strong> objects needed to properly configure storage for the examples, an additional role is
needed. Specifically, a new role is needed that can both create and delete <strong>Persistent Volumes</strong>.</p>
</div>
<div class="paragraph">
<p>Using the following two commands, create a new Cluster Role that has the ability to create and delete
persistent volumes, and then assign that role to your current user:</p>
</div>
<div class="paragraph">
<div class="notices warning" ><div class="paragraph">
<p>Please be aware that the following two commands require privileges that your current user may not
have. In the event that you are unable to run these commands, and do not have access to a user
that is able to run them (e.g., the <strong>system:admin</strong> user that is created by default when
installing OCP), please contact your local OCP administrator to run the commands on your behalf, or
grant you the access required to run them yourself.</p>
</div>
</div>

</div>
<div class="literalblock">
<div class="content">
<pre>$ oc create clusterrole crunchytester --verb="list,create,delete" --resource=persistentvolumes
clusterrole "crunchytester" created

$ oc adm policy add-cluster-role-to-user crunchytester someuser
cluster role "crunchytester" added: "someuser"</pre>
</div>
</div>
<div class="paragraph">
<p>Your user should now have the roles and privileges required to run the examples.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next, build or pull the container images as demonstrated in the <a href="https://crunchydata.github.io/crunchy-containers/stable/installation/build-the-containers/">Build the Containers</a> document.</p>
</div>
</div>
</div>


    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="https://crunchydata.github.io/crunchy-containers/stable/installation/" title="Installation"> <i class="fa fa-chevron-left"></i><label>Installation</label></a>
    <a class="nav nav-next" href="https://crunchydata.github.io/crunchy-containers/stable/installation/build-the-containers/" title="Build the Containers" style="margin-right: 0px;"><label>Build the Containers</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="https://crunchydata.github.io/crunchy-containers/stable/js/clipboard.min.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/stable/js/featherlight.min.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/stable/js/html5shiv-printshiv.min.js"></script>

<script src="https://crunchydata.github.io/crunchy-containers/stable/js/modernizr.custom.71422.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/stable/js/docdock.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/stable/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>